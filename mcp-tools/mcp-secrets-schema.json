{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://vauntico.com/schemas/mcp-secrets.json",
  "title": "Vauntico MCP Secrets Connector Schema",
  "description": "JSON Schema for Secrets MCP connector operations including rotation, audit, and backup across multiple providers",
  "type": "object",
  "properties": {
    "connector": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "const": "mcp-secrets",
          "description": "Connector identifier"
        },
        "version": {
          "type": "string",
          "const": "1.0.0",
          "description": "Connector version"
        },
        "description": {
          "type": "string",
          "const": "Enterprise secrets management with rotation, audit, and backup capabilities across multiple providers",
          "description": "Connector description"
        },
        "capabilities": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of supported capabilities",
          "enum": [
            "secrets_rotation",
            "secrets_audit",
            "secrets_backup",
            "github_secrets",
            "neon_secrets",
            "stripe_secrets",
            "resend_secrets",
            "paystack_secrets"
          ]
        }
      },
      "required": ["name", "version", "description", "capabilities"]
    },
    "operations": {
      "type": "object",
      "properties": {
        "secrets_rotate": {
          "type": "object",
          "description": "Rotate secrets for a specific provider",
          "properties": {
            "provider": {
              "type": "string",
              "description": "Secret provider to rotate",
              "enum": ["github", "neon", "stripe", "resend", "paystack"]
            },
            "key_id": {
              "type": "string",
              "description": "Key identifier (for GitHub)",
              "minLength": 1
            },
            "secret_name": {
              "type": "string",
              "description": "Name of the secret to rotate",
              "minLength": 1,
              "maxLength": 64
            },
            "new_value": {
              "type": "string",
              "description": "New secret value",
              "minLength": 1
            }
          },
          "required": ["provider", "secret_name", "new_value"]
        },
        "secrets_audit": {
          "type": "object",
          "description": "Audit secrets for leakage and compliance issues",
          "properties": {
            "provider": {
              "type": "string",
              "description": "Secret provider to audit",
              "enum": ["all", "github", "neon", "stripe", "resend", "paystack"],
              "default": "all"
            },
            "deep_scan": {
              "type": "boolean",
              "description": "Perform deep scan across all branches and history",
              "default": false
            },
            "check_rotation": {
              "type": "boolean",
              "description": "Check if secrets need rotation",
              "default": true
            }
          },
          "required": ["provider"]
        },
        "secrets_backup": {
          "type": "object",
          "description": "Create backup of all secrets",
          "properties": {
            "provider": {
              "type": "string",
              "description": "Secret provider to backup",
              "enum": ["all", "github", "neon", "stripe", "resend", "paystack"],
              "default": "all"
            },
            "backup_location": {
              "type": "string",
              "description": "Location to store backup"
            },
            "include_values": {
              "type": "boolean",
              "description": "Include actual secret values in backup (DANGEROUS)",
              "default": false
            },
            "encrypt_backup": {
              "type": "boolean",
              "description": "Encrypt the backup file",
              "default": true
            }
          },
          "required": ["provider"]
        },
        "github_secrets_list": {
          "type": "object",
          "description": "List GitHub repository secrets",
          "properties": {
            "owner": {
              "type": "string",
              "description": "Repository owner username or organization name",
              "minLength": 1,
              "maxLength": 39
            },
            "repo": {
              "type": "string",
              "description": "Repository name",
              "minLength": 1,
              "maxLength": 100
            }
          },
          "required": ["owner", "repo"]
        },
        "github_secrets_set": {
          "type": "object",
          "description": "Create or update GitHub repository secret",
          "properties": {
            "owner": {
              "type": "string",
              "description": "Repository owner username or organization name",
              "minLength": 1,
              "maxLength": 39
            },
            "repo": {
              "type": "string",
              "description": "Repository name",
              "minLength": 1,
              "maxLength": 100
            },
            "secret_name": {
              "type": "string",
              "description": "Name of the secret",
              "minLength": 1,
              "maxLength": 64
            },
            "secret_value": {
              "type": "string",
              "description": "Value of the secret",
              "minLength": 1
            }
          },
          "required": ["owner", "repo", "secret_name", "secret_value"]
        },
        "stripe_secrets_rotate": {
          "type": "object",
          "description": "Rotate Stripe API keys",
          "properties": {
            "account_id": {
              "type": "string",
              "description": "Stripe account ID",
              "minLength": 1
            },
            "key_type": {
              "type": "string",
              "description": "Type of key to rotate",
              "enum": ["publishable", "secret"],
              "default": "publishable"
            }
          },
          "required": ["account_id", "key_type"]
        }
      }
    },
    "providers": {
      "type": "object",
      "properties": {
        "github": {
          "type": "object",
          "properties": {
            "description": "GitHub repository secrets management",
            "capabilities": ["list", "get", "set", "delete", "rotate"],
            "api_version": "v4",
            "authentication": "required"
          }
        },
        "neon": {
          "type": "object",
          "properties": {
            "description": "Neon PostgreSQL database connection management",
            "capabilities": ["list", "rotate"],
            "api_version": "v1",
            "authentication": "required"
          }
        },
        "stripe": {
          "type": "object",
          "properties": {
            "description": "Stripe payment processor API key management",
            "capabilities": ["list", "rotate"],
            "api_version": "v2023-10-16",
            "authentication": "required"
          }
        },
        "resend": {
          "type": "object",
          "properties": {
            "description": "Resend email service API key management",
            "capabilities": ["list", "rotate"],
            "api_version": "v1",
            "authentication": "required"
          }
        },
        "paystack": {
          "type": "object",
          "properties": {
            "description": "Paystack payment processor API key management",
            "capabilities": ["list", "rotate"],
            "api_version": "v1",
            "authentication": "required"
          }
        }
      }
    },
    "authentication": {
      "type": "object",
      "properties": {
        "required_env_vars": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Required environment variables for authentication",
          "enum": [
            "GITHUB_TOKEN",
            "NEON_API_KEY",
            "STRIPE_SECRET_KEY",
            "RESEND_API_KEY",
            "PAYSTACK_SECRET_KEY"
          ]
        },
        "token_requirements": {
          "type": "object",
          "properties": {
            "github": {
              "type": "string",
              "description": "GitHub Personal Access Token with repo and secrets permissions"
            },
            "neon": {
              "type": "string",
              "description": "Neon API key with project access"
            },
            "stripe": {
              "type": "string",
              "description": "Stripe Secret Key with API access"
            },
            "resend": {
              "type": "string",
              "description": "Resend API key with sending permissions"
            },
            "paystack": {
              "type": "string",
              "description": "Paystack Secret Key with API access"
            }
          }
        }
      },
      "required": ["required_env_vars", "token_requirements"]
    },
    "security": {
      "type": "object",
      "properties": {
        "encryption": {
          "type": "object",
          "properties": {
            "backup_encryption": {
              "type": "boolean",
              "const": true,
              "description": "AES-256 encryption for backup files"
            },
            "transit_encryption": {
              "type": "boolean",
              "const": true,
              "description": "Encryption during secret transmission"
            },
            "at_rest_encryption": {
              "type": "boolean",
              "const": true,
              "description": "Secrets stored encrypted at rest"
            }
          }
        },
        "audit_features": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Security audit capabilities",
          "enum": [
            "secret_age_analysis",
            "permission_audit",
            "access_log_review",
            "compliance_check",
            "leak_detection",
            "rotation_schedule"
          ]
        },
        "risk_assessment": {
          "type": "object",
          "properties": {
            "levels": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "enum": ["low", "medium", "high", "critical"]
            },
            "factors": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "enum": [
                "age_days",
                "access_frequency",
                "permission_level",
                "data_sensitivity",
                "compliance_requirements"
              ]
            }
          }
        }
      }
    },
    "error_handling": {
      "type": "object",
      "properties": {
        "enterprise_grade": {
          "type": "boolean",
          "const": true,
          "description": "Enterprise-grade error handling enabled"
        },
        "retry_policy": {
          "type": "object",
          "properties": {
            "max_retries": {
              "type": "integer",
              "minimum": 0,
              "maximum": 10,
              "default": 3
            },
            "backoff_strategy": {
              "type": "string",
              "enum": ["exponential", "linear", "fixed"],
              "default": "exponential"
            },
            "base_delay": {
              "type": "integer",
              "minimum": 100,
              "maximum": 5000,
              "default": 1000
            }
          }
        },
        "error_types": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Supported error types",
          "enum": [
            "authentication_error",
            "authorization_error",
            "rate_limit_error",
            "not_found_error",
            "validation_error",
            "encryption_error",
            "backup_error",
            "rotation_error"
          ]
        }
      }
    }
  },
  "required": [
    "connector",
    "operations",
    "providers",
    "authentication",
    "security",
    "error_handling"
  ],
  "additionalProperties": false
}
